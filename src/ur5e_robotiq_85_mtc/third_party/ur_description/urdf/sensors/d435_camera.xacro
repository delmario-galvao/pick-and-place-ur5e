<?xml version="1.0"?>
<robot xmlns:xacro="http://ros.org/wiki/xacro">

  <!-- macro recebe o link‑pai e o deslocamento -->
  <xacro:macro name="d435_camera" params="
      parent:=tool0
      xyz:='0 0 0.12'
      rpy:='0 0 0'
      prefix:=''">

    <!-- joint fixo -->
    <joint name="${prefix}tool0_d435" type="fixed">
      <parent link="${parent}"/>
      <child  link="${prefix}d435_link"/>
      <origin xyz="${xyz}" rpy="${rpy}"/>
    </joint>

    <!-- link da câmera -->
    <link name="${prefix}d435_link">
      <visual>
        <geometry>
          <mesh filename="package://realsense2_description/meshes/d435.dae"/>
        </geometry>
      </visual>
      <collision><geometry><box size="0.09 0.025 0.025"/></geometry></collision>
      <inertial><mass value="0.072"/><inertia ixx="1e‑4" iyy="1e‑4" izz="1e‑4"/></inertial>
    </link>

    <!-- sensor Gazebo -->
    <gazebo reference="${prefix}d435_link">
      <sensor type="depth" name="${prefix}d435_depth">
        <always_on>true</always_on>
        <update_rate>30.0</update_rate>
        <camera>
          <horizontal_fov>1.3962634</horizontal_fov>
          <image><width>800</width><height>600</height></image>
          <clip><near>0.1</near><far>10.0</far></clip>
        </camera>
        <plugin name="${prefix}depth_cam" filename="libgazebo_ros_depth_camera.so">
          <frame_name>${prefix}d435_link</frame_name>
          <depth_image_topic_name>depth/image_raw</depth_image_topic_name>
          <camera_info_topic_name>depth/camera_info</camera_info_topic_name>
          <point_cloud_topic_name>depth/points</point_cloud_topic_name>
        </plugin>
      </sensor>
    </gazebo>

  </xacro:macro>
</robot>
